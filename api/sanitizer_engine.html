<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Sanitizer Engine API | WAFIShield</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Sanitizer Engine API" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A two-layer, fully-extensible Python package for protecting LLM/agent apps against OWASP Top 10 and other evolving LLM vulnerabilities" />
<meta property="og:description" content="A two-layer, fully-extensible Python package for protecting LLM/agent apps against OWASP Top 10 and other evolving LLM vulnerabilities" />
<meta property="og:site_name" content="WAFIShield" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Sanitizer Engine API" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"A two-layer, fully-extensible Python package for protecting LLM/agent apps against OWASP Top 10 and other evolving LLM vulnerabilities","headline":"Sanitizer Engine API","url":"/api/sanitizer_engine.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style" type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/assets/css/style.css?v=85dce181030e73119dda003153bb1b3cf18ed980">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <a id="skip-to-content" href="#content">Skip to the content.</a>

    <header class="page-header" role="banner">
      <h1 class="project-name">Sanitizer Engine API</h1>
      <h2 class="project-tagline">A two-layer, fully-extensible Python package for protecting LLM/agent apps against OWASP Top 10 and other evolving LLM vulnerabilities</h2>
      
        <a href="https://github.com/duestack/wafishield" class="btn">View on GitHub</a>
      
      
        <a href="https://github.com/duestack/wafishield/zipball/gh-pages" class="btn">Download .zip</a>
        <a href="https://github.com/duestack/wafishield/tarball/gh-pages" class="btn">Download .tar.gz</a>
      
    </header>

    <main id="content" class="main-content" role="main">
      <h1 id="sanitizer-engine-api-reference">Sanitizer Engine API Reference</h1>

<p>The <code class="language-plaintext highlighter-rouge">SanitizerEngine</code> class handles the detection and redaction of sensitive information from text.</p>

<h2 id="pattern-definition">Pattern Definition</h2>

<p>Sanitizer patterns are defined in YAML files with the following structure:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">PII_EMAIL</span>
  <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Redact</span><span class="nv"> </span><span class="s">email</span><span class="nv"> </span><span class="s">addresses"</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">regex</span>
  <span class="na">pattern</span><span class="pi">:</span> <span class="s2">"</span><span class="s">[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+</span><span class="se">\\</span><span class="s">.[a-zA-Z]{2,}"</span>
  <span class="na">action</span><span class="pi">:</span> <span class="s">redact</span>
  <span class="na">replacement</span><span class="pi">:</span> <span class="s2">"</span><span class="s">[REDACTED_EMAIL]"</span>
  <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div>

<h2 id="methods">Methods</h2>

<h3 id="sanitize">sanitize()</h3>

<p>Sanitizes text by replacing sensitive information based on configured patterns.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span> <span class="o">=</span> <span class="n">sanitizer_engine</span><span class="p">.</span><span class="n">sanitize</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Parameters:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">text</code> (str): The text to sanitize</li>
  <li><code class="language-plaintext highlighter-rouge">context</code> (dict, optional): Contextual information</li>
</ul>

<p><strong>Returns:</strong></p>
<ul>
  <li>Dictionary with:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">sanitized_text</code> (str): The sanitized version of the text</li>
      <li><code class="language-plaintext highlighter-rouge">patterns_matched</code> (list): List of pattern IDs that were matched</li>
      <li><code class="language-plaintext highlighter-rouge">match_count</code> (int): Total number of matches</li>
      <li><code class="language-plaintext highlighter-rouge">replacement_count</code> (int): Total number of replacements made</li>
    </ul>
  </li>
</ul>

<h3 id="register_pattern">register_pattern()</h3>

<p>Registers a custom pattern or a callback for an existing pattern.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sanitizer_engine</span><span class="p">.</span><span class="n">register_pattern</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Parameters:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">pattern</code> (dict or str): Pattern definition or pattern ID</li>
  <li><code class="language-plaintext highlighter-rouge">callback</code> (callable, optional): Function to call when pattern matches</li>
</ul>

<h2 id="pattern-types">Pattern Types</h2>

<p>WAFIShield supports the following pattern types:</p>

<h3 id="regex">Regex</h3>

<p>Uses regular expressions to match and redact sensitive information.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">CREDIT_CARD</span>
  <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Redact</span><span class="nv"> </span><span class="s">credit</span><span class="nv"> </span><span class="s">card</span><span class="nv"> </span><span class="s">numbers"</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">regex</span>
  <span class="na">pattern</span><span class="pi">:</span> <span class="s2">"</span><span class="se">\\</span><span class="s">b(?:</span><span class="se">\\</span><span class="s">d{4}[-</span><span class="nv"> </span><span class="s">]?){3}</span><span class="se">\\</span><span class="s">d{4}</span><span class="se">\\</span><span class="s">b"</span>
  <span class="na">action</span><span class="pi">:</span> <span class="s">redact</span>
  <span class="na">replacement</span><span class="pi">:</span> <span class="s2">"</span><span class="s">[REDACTED_CREDIT_CARD]"</span>
  <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div>

<h3 id="dictionary">Dictionary</h3>

<p>Matches against a predefined list of sensitive terms.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">RESTRICTED_TERMS</span>
  <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Redact</span><span class="nv"> </span><span class="s">internal</span><span class="nv"> </span><span class="s">project</span><span class="nv"> </span><span class="s">names"</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">dictionary</span>
  <span class="na">terms</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">Project</span><span class="nv"> </span><span class="s">Alpha"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">Project</span><span class="nv"> </span><span class="s">Beta"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">Project</span><span class="nv"> </span><span class="s">Gamma"</span>
  <span class="na">action</span><span class="pi">:</span> <span class="s">redact</span>
  <span class="na">replacement</span><span class="pi">:</span> <span class="s2">"</span><span class="s">[REDACTED_PROJECT]"</span>
  <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div>

<h2 id="actions">Actions</h2>

<p>WAFIShield supports the following actions for matched patterns:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">redact</code>: Replace the matched text with a placeholder</li>
  <li><code class="language-plaintext highlighter-rouge">hash</code>: Replace the matched text with a hash of the original</li>
  <li><code class="language-plaintext highlighter-rouge">mask</code>: Show partial information (e.g., last 4 digits of credit card)</li>
  <li><code class="language-plaintext highlighter-rouge">flag</code>: Don’t alter the text, but flag it as containing sensitive info</li>
</ul>

<h2 id="custom-pattern-callbacks">Custom Pattern Callbacks</h2>

<p>You can register custom callbacks to handle pattern matches:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">custom_pattern_handler</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">original_text</span><span class="p">,</span> <span class="n">sanitized_text</span><span class="p">,</span> <span class="n">matches</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="c1"># Log the detection
</span>    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Pattern </span><span class="si">{</span><span class="n">pattern</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span><span class="si">}</span><span class="s"> matched </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span><span class="si">}</span><span class="s"> times"</span><span class="p">)</span>
    
    <span class="c1"># You can implement custom sanitization logic
</span>    <span class="c1"># For example, replacing with a consistent identifier per match
</span>    <span class="kn">import</span> <span class="nn">hashlib</span>
    
    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
        <span class="n">match_text</span> <span class="o">=</span> <span class="n">match</span><span class="p">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">hash_id</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span><span class="n">match_text</span><span class="p">.</span><span class="n">encode</span><span class="p">()).</span><span class="n">hexdigest</span><span class="p">()[:</span><span class="mi">8</span><span class="p">]</span>
        <span class="n">sanitized_text</span> <span class="o">=</span> <span class="n">sanitized_text</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="sa">f</span><span class="s">"[</span><span class="si">{</span><span class="n">pattern</span><span class="p">[</span><span class="s">'replacement'</span><span class="p">]</span><span class="si">}</span><span class="s">]"</span><span class="p">,</span> 
            <span class="sa">f</span><span class="s">"[</span><span class="si">{</span><span class="n">pattern</span><span class="p">[</span><span class="s">'replacement'</span><span class="p">]</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">hash_id</span><span class="si">}</span><span class="s">]"</span><span class="p">,</span>
            <span class="mi">1</span>
        <span class="p">)</span>
    
    <span class="k">return</span> <span class="n">sanitized_text</span>

<span class="n">sanitizer_engine</span><span class="p">.</span><span class="n">register_pattern</span><span class="p">(</span><span class="s">"PII_EMAIL"</span><span class="p">,</span> <span class="n">custom_pattern_handler</span><span class="p">)</span>
</code></pre></div></div>


      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="https://github.com/duestack/wafishield">wafishield</a> is maintained by <a href="https://github.com/duestack">duestack</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </main>
  </body>
</html>
